var CircleSplit=function(t){function i(n){if(e[n])return e[n].exports;var s=e[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){function n(t,i,e){return t>e.x-e.r&&t<e.x+e.r&&i>e.y-e.r&&i<e.y+e.r}function s(t,i){var e={minDiameter:2,size:"auto",imageCenterType:"contain"};i||(i={}),this.options={};for(var n in e)null!==i[n]&&void 0!==i[n]?this.options[n]=i[n]:this.options[n]=e[n];this.el="object"==typeof t?t:document.querySelector(t),"auto"===this.options.size&&(this.options.size=Math.min(this.el.clientWidth,this.el.clientHeight)),this.canvasSize=this.options.size*h,this.diameter=this.canvasSize/2,this.circles=[],this.renderingCircles=[],this.sourceCanvas=null,this.targetCanvas=null,this.sourceImage=null,this.requestAnimationSeed=0,this.moveEvent="ontouchstart"in window?"touchmove":"mousemove",this.moveHandler=this._onMove.bind(this),this.rect=this.el.getBoundingClientRect(),this._init()}var r=e(1),h=2;s.prototype={constructor:s,_init:function(){this._createSourceCanvas(),this._createTargetCanvas(),this._render(),this.bindEvent()},_createSourceCanvas:function(){this.sourceCanvas=document.createElement("canvas"),this.sourceCanvas.width=this.canvasSize,this.sourceCanvas.height=this.canvasSize},_createTargetCanvas:function(){this.targetCanvas=document.createElement("canvas"),this.targetCanvas.width=this.canvasSize,this.targetCanvas.height=this.canvasSize,this.targetCanvas.style.width=this.targetCanvas.style.height=this.options.size+"px",this.el.appendChild(this.targetCanvas)},_drawSourceImage:function(){var t=this.canvasSize,i=new r({containerWidth:t,containerHeight:t,originWidth:this.sourceImage.naturalWidth,originHeight:this.sourceImage.naturalHeight,centerType:this.options.imageCenterType}),e=this.sourceCanvas.getContext("2d");e.clearRect(0,0,t,t),e.drawImage(this.sourceImage,i.offset().left,i.offset().top,i.width(),i.height())},_drawCircle:function(){var t,i,e,n=this.targetCanvas.getContext("2d");3===arguments.length?(t=arguments[0],i=arguments[1],e=arguments[2],this.circles.push({x:t,y:i,r:e})):(t=arguments[0].x,i=arguments[0].y,e=arguments[0].r),n.fillStyle=this._getPixelRGBColor(t,i),n.beginPath(),n.arc(t,i,e,0,2*Math.PI),n.closePath(),n.fill()},_onMove:function(t){var i="ontouchstart"in window,e=this.rect;i?this._tagCircle((t.touches[0].pageX-e.left)*h,(t.touches[0].pageY-e.top)*h):this._tagCircle(t.offsetX*h,t.offsetY*h),t.preventDefault(),t.stopPropagation()},_tagCircle:function(t,i){var e=this.findCircle(t,i,function(t){return!t.readyToSplit}),n=this.circles[e];n&&(n.readyToSplit=!0,this.renderingCircles.push({x:n.x,y:n.y,r:n.r,index:e}))},_getPixelRGBColor:function(t,i){var e=this.sourceCanvas.getContext("2d").getImageData(parseInt(t),parseInt(i),1,1).data;return"rgb("+e[0]+","+e[1]+","+e[2]+")"},_splitCircle:function(t){var i=this.targetCanvas.getContext("2d"),e=this.circles[t.index],n=t.r/2;i.clearRect(t.x-t.r,t.y-t.r,2*t.r,2*t.r),this._drawCircle(t.x+n,t.y-n,n),this._drawCircle(t.x-n,t.y+n,n),this._drawCircle(t.x+n,t.y+n,n),e.x-=n,e.y-=n,e.r=n,this._drawCircle(e)},_render:function(){for(var t,i=this.options.minDiameter*h,e=this.renderingCircles;t=e.pop();)this.circles[t.index].readyToSplit=!1,t.r>i&&this._splitCircle(t);this.requestAnimationSeed=requestAnimationFrame(this._render.bind(this))},bindEvent:function(){this.targetCanvas.addEventListener(this.moveEvent,this.moveHandler)},unbindEvent:function(){this.targetCanvas.removeEventListener(this.moveEvent,this.moveHandler)},findCircle:function(t,i,e){var s,r=this.circles,h=null;for(s=0;s<r.length&&(h=r[s],!n(t,i,h)||e&&!e(h));s++);return s===r.length?-1:s},setImage:function(t){var i=this.canvasSize;this.circles=[],this.targetCanvas.getContext("2d").clearRect(0,0,i,i),"string"==typeof t?(this.sourceImage=new Image,t.startsWith("data:image")||(this.sourceImage.crossOrigin="anonymous"),this.sourceImage.onload=function(){this._drawSourceImage(),this._drawCircle(this.targetCanvas.width/2,this.targetCanvas.height/2,this.diameter)}.bind(this),this.sourceImage.src=t):(this.sourceImage=t,this._drawSourceImage(),this._drawCircle(this.targetCanvas.width/2,this.targetCanvas.height/2,this.diameter))},split:function(t,i){var e=this.options.minDiameter*h;2===arguments.length?this._tagCircle(t,i):(this.renderingCircles=[],this.circles.forEach(function(t,i){t.r>e&&this.renderingCircles.push({x:t.x,y:t.y,r:t.r,index:i})},this))},merge:function(t,i){console.warn("not implemented yet");var e=this.findCircle(t,i),n=this.circles[e],s=0;n&&(s=this.getLevel(n)-1)},getLevel:function(t){return Math.log2(this.canvasSize/("object"==typeof t?t.r:t))},destroy:function(){cancelAnimationFrame(this.requestAnimationSeed),this.unbindEvent(),this.sourceCanvas=null,this.targetCanvas=null,this.sourceImage=null,this.circles=[]}},t.exports=s},function(t,i,e){!function(i,e){t.exports=e()}(this,function(){"use strict";function t(t){t=t||{},this.options={containerWidth:100,containerHeight:100,originWidth:100,originHeight:100,centerType:"cover"};for(var i in this.options)void 0!==t[i]&&(this.options[i]=t[i]);this._ratio=1,this._newWidth=0,this._newHeight=0,this._offset={top:0,left:0},"cover"===this.options.centerType?this._coverCenter():this._containCenter()}return t.prototype={constructor:t,_coverCenter:function(){var t=this.options.originWidth,i=this.options.originHeight,e=this.options.containerWidth,n=this.options.containerHeight,s=t/i,r=e/n,h=1;s>r?(h=n/i,this._newWidth=t*h,this._newHeight=i*h,this._offset={top:0,left:(this._newWidth-e)/-2}):s<r?(h=e/t,this._newWidth=t*h,this._newHeight=i*h,this._offset={top:(this._newHeight-n)/-2,left:0}):(h=e/t,this._newWidth=t*h,this._newHeight=i*h,this._offset={top:0,left:0}),this._ratio=h},_containCenter:function(){var t=this.options.originWidth,i=this.options.originHeight,e=this.options.containerWidth,n=this.options.containerHeight,s=t/i,r=e/n,h=1;s>r?(h=e/t,this._newWidth=t*h,this._newHeight=i*h,this._offset={top:(this._newHeight-n)/-2,left:0}):s<r?(h=n/i,this._newWidth=t*h,this._newHeight=i*h,this._offset={top:0,left:(this._newWidth-e)/-2}):(h=e/t,this._newWidth=t*h,this._newHeight=i*h,this._offset={top:0,left:0}),this._ratio=h},ratio:function(){return this._ratio},width:function(){return this._newWidth},height:function(){return this._newHeight},offset:function(){return this._offset}},t})}]);